<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>線上存證信函產生器｜免費自動生成法律格式信件</title>
    <meta name="description" content="本網站提供簡易快速的線上存證信函產生器，免費幫助您生成具法律格式的信函，適用於債務催收、騷擾警告等場景。">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://legal-letter.otus.tw/">
    <meta name="author" content="黑田">

    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4397281842502641"
     crossorigin="anonymous"></script>
    <style>
      :root {
        --primary-color: #3b5d50;
        --secondary-color: #f9bf29;
        --bg-light: #f8f9fa;
        --text-dark: #2d3b38;
        --border-radius: 8px;
        --box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      body {
        font-family: 'Noto Sans TC', sans-serif;
        background-color: var(--bg-light);
        color: var(--text-dark);
        line-height: 1.6;
      }
      .site-header {
        background: linear-gradient(135deg, var(--primary-color), #2d4f43);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
        border-radius: 0 0 var(--border-radius) var(--border-radius);
        box-shadow: var(--box-shadow);
      }
      .site-title {
        font-weight: 700;
        margin-bottom: 0.5rem;
      }
      .site-description {
        opacity: 0.9;
        font-weight: 300;
      }
      .card {
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        margin-bottom: 1rem;
        border: none;
        transition: transform 0.3s ease;
      }
      .card:hover {
        transform: translateY(-5px);
      }
      .card-header {
        background-color: var(--primary-color);
        color: white;
        border-radius: var(--border-radius) var(--border-radius) 0 0 !important;
      }
      .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
      }
      .btn-primary:hover {
        background-color: #2d4f43;
        border-color: #2d4f43;
      }
      .btn-warning {
        background-color: var(--secondary-color);
        border-color: var(--secondary-color);
        color: var(--text-dark);
      }
      .btn-danger {
        background-color: #e74c3c;
        border-color: #e74c3c;
      }
      .btn {
        border-radius: var(--border-radius);
        font-weight: 500;
        padding: 0.5rem 1.5rem;
      }
      .form-control {
        border-radius: var(--border-radius);
        padding: 0.75rem;
        border: 1px solid #ced4da;
      }
      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.25rem rgba(59, 93, 80, 0.25);
      }
      textarea.form-control {
        min-height: 150px;
      }
      .section-title {
        position: relative;
        display: inline-block;
        padding-bottom: 0.5rem;
        margin-bottom: 1.5rem;
        font-weight: 600;
        color: var(--primary-color);
      }
      .section-title:after {
        content: '';
        position: absolute;
        left: 0;
        bottom: 0;
        width: 50px;
        height: 3px;
        background-color: var(--secondary-color);
      }
      .info-section {
        background-color: white;
        border-radius: var(--border-radius);
        padding: 1.5rem;
        box-shadow: var(--box-shadow);
      }
      .info-title {
        color: var(--primary-color);
        font-weight: 600;
        margin-bottom: 1rem;
      }
      .info-content {
        margin-bottom: 1.5rem;
      }
      .address-section {
        background-color: white;
        border-radius: var(--border-radius);
        padding: 1.5rem;
        height: 100%;
        box-shadow: var(--box-shadow);
      }
      .footer {
        background-color: var(--primary-color);
        color: white;
        padding: 1rem 0;
        margin-top: 3rem;
        text-align: center;
        border-radius: var(--border-radius) var(--border-radius) 0 0;
      }
      .icon-text {
        display: flex;
        align-items: center;
      }
      .icon-text i {
        margin-right: 0.5rem;
        color: var(--secondary-color);
      }
    </style>
  </head>
  <body>
    <!-- 页面头部 -->
    <header class="site-header">
      <div class="container">
        <div class="row">
          <div class="col-md-12 text-center">
            <h1 class="site-title">台灣郵局-存證信函產生器</h1>
            <p class="site-description">免費快速產生格式合法、美觀的存證信函</p>
          </div>
        </div>
      </div>
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4397281842502641" crossorigin="anonymous"></script>
    </header>

    <div class="container">
      <!-- 導航菜單 -->
      <div class="row">
        <div class="col-md-12">
          <div class="nav-menu" style="background-color: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 2rem; padding: 0.5rem;">
            <ul class="nav justify-content-center">
              <li class="nav-item">
                <a class="nav-link active" href="/" style="color: #f9bf29; font-weight: 700;">首頁</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/privacy-policy" style="color: #3b5d50; font-weight: 500;">隱私權政策</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/faq" style="color: #3b5d50; font-weight: 500;">常見問題</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/about" style="color: #3b5d50; font-weight: 500;">關於我們</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/terms" style="color: #3b5d50; font-weight: 500;">服務條款</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/contact" style="color: #3b5d50; font-weight: 500;">聯絡我們</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/sitemap" style="color: #3b5d50; font-weight: 500;">網站地圖</a>
              </li>
              <!-- 暫時停用贊助按鈕：綠界審核未通過，避免捐款失敗
              <li class="nav-item">
                <a class="nav-link" href="/donate" style="color: #d9534f; font-weight: 700;">贊助 NT$50</a>
              </li>
              -->
            </ul>
          </div>
        </div>
      </div>
      <!-- 地址信息部分 -->
      <div class="row mb-4">
        <div class="col-md-4">
          <div class="address-section">
            <h5 class="section-title">
              <i class="fas fa-paper-plane"></i> 寄件人資訊
            </h5>
            <div class="from_cards mb-3"></div>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#adressModal" data-bs-whatever="寄件人">
              <i class="fas fa-plus"></i> 新增寄件人
            </button>
          </div>
        </div>
        <div class="col-md-4">
          <div class="address-section">
            <h5 class="section-title">
              <i class="fas fa-user"></i> 收件人資訊
            </h5>
            <div class="to_cards mb-3"></div>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#adressModal" data-bs-whatever="收件人">
              <i class="fas fa-plus"></i> 新增收件人
            </button>
          </div>
        </div>
        <div class="col-md-4">
          <div class="address-section">
            <h5 class="section-title">
              <i class="fas fa-copy"></i> 副本收件人資訊
            </h5>
            <div class="copy_cards mb-3"></div>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#adressModal" data-bs-whatever="副本地址">
              <i class="fas fa-plus"></i> 新增副本收件人
            </button>
          </div>
        </div>
      </div>

      <!-- 信函内容部分 -->
      <div class="row mb-4">
        <div class="col-md-12">
          <div class="info-section">
            <h5 class="section-title">
              <i class="fas fa-envelope-open-text"></i> 信函內容
            </h5>
            <form role="form">
              <div class="form-group mb-3">
                <label for="letter_content" class="form-label">請輸入信函內容：</label>
                <textarea class="form-control" id="letter_content" rows="8" placeholder="請在此輸入您的信函內容..."></textarea>
              </div>
              <div class="d-flex justify-content-between">
                <button type="button" class="btn btn-warning" id="clear">
                  <i class="fas fa-eraser"></i> 清除內文
                </button>
                <button type="button" class="btn btn-primary" id="generate" onclick="download()">
                  <i class="fas fa-file-pdf"></i> 產生存證信函
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- 说明信息部分 -->
      <div class="row mb-4">
        <div class="col-md-12">
          <div class="info-section">
            <h5 class="section-title">
              <i class="fas fa-info-circle"></i> 使用說明
            </h5>
            <div class="info-content">
              <div class="alert alert-warning" role="alert">
                <i class="fas fa-gavel"></i> <strong>法律免責聲明：</strong>本站內容不構成法律意見。使用本工具產生的文件僅供參考，在處理法律事務時，建議諮詢專業律師獲取正確的法律建議。
              </div>

              <div class="alert alert-info" role="alert">
                <i class="fas fa-shield-alt"></i> 檔案不會儲存在伺服器，所有資料僅在您的瀏覽器中處理，請放心使用。
              </div>
              
              <h5 class="mt-4 mb-3">存證信函是什麼？有什麼用途？</h5>
              <p>存證信函是通過郵局寄送的具有存證效力的信件，是一種民事法律行為中的證據保全方式。當您與他人發生爭議需要保留證據，或希望正式通知對方某些事項時，存證信函是一種經濟實惠且具有法律效力的工具。</p>
              
              <p>存證信函的主要用途包括：</p>
              <ul class="mb-3">
                <li>商業糾紛中的正式通知（如債務催收、合約終止）</li>
                <li>消費爭議中向廠商提出退換貨或賠償要求</li>
                <li>租賃關係中的通知（如終止租約、維修要求）</li>
                <li>勞資爭議中的權益主張</li>
                <li>作為日後可能訴訟程序的前置證據</li>
                <li>表達正式的法律立場或保留相關權利</li>
              </ul>

              <h5 class="mb-3">為什麼要用掛號方式寄送存證信函？</h5>
              <p>存證信函需透過郵局<strong>掛號或雙掛號</strong>方式寄送，這是因為：</p>
              <ul class="mb-3">
                <li>郵局會提供<strong>收件證明</strong>，作為寄件時間及對象的證明</li>
                <li>掛號信件<strong>具有追蹤功能</strong>，可確認信件是否送達</li>
                <li>雙掛號更可取得<strong>收件人簽收的回執</strong>，是更完整的送達證明</li>
                <li>在法律程序中，掛號方式寄送的存證信函<strong>具有較高的證據能力</strong></li>
                <li>郵局會保存掛號郵件相關資料達一定期限，可作為送達證明的補強</li>
              </ul>

              <h5 class="mb-3">使用本工具的操作步驟：</h5>
              <ol class="list-group list-group-numbered mb-3">
                <li class="list-group-item d-flex"><span class="ms-2">填寫<strong>寄件人資訊</strong>（您的姓名、地址等）</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">填寫<strong>收件人資訊</strong>（對方的姓名、地址等）</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">如需副本，可新增<strong>副本收件人資訊</strong></span></li>
                <li class="list-group-item d-flex"><span class="ms-2">撰寫<strong>信函內容</strong>，條理清晰地陳述事實和訴求</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">點擊「<strong>產生存證信函</strong>」按鈕，下載生成的 PDF 文件</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">將 PDF 檔案<strong>列印出來</strong>，帶至郵局以掛號或雙掛號方式寄出</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">保留郵局提供的<strong>收據及掛號編號</strong>，以便日後查詢或作為證明</span></li>
              </ol>
              
              <h5 class="mb-3">撰寫存證信函要點：</h5>
              <ol class="list-group list-group-numbered mb-3">
                <li class="list-group-item d-flex"><span class="ms-2">以<strong>客觀事實</strong>為基礎，詳細寫出完整經過</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">明確表達<strong>自己的訴求</strong>和期望對方採取的行動</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">使用<strong>正式且禮貌</strong>的用語，避免情緒性字眼</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">切記<strong>不要寫對自己不利</strong>的內容或承認過錯</span></li>
                <li class="list-group-item d-flex"><span class="ms-2">可在結尾設定<strong>回應期限</strong>，並說明若無回應將採取的後續行動</span></li>
              </ol>
              
              <p class="mb-0">
                <i class="fas fa-envelope"></i> 如果有任何問題或建議，請寄信聯絡我們：
                <a href="mailto:kyjita@gmail.com" class="text-decoration-none">kyjita@gmail.com</a>
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- 地址模态框 -->
      <div class="modal fade" id="adressModal" tabindex="-1" aria-labelledby="adressModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="adressModalLabel">新增地址資訊</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="mb-3">
                  <label for="name" class="col-form-label">姓名或單位名稱:</label>
                  <input type="text" class="form-control" id="name" placeholder="請輸入姓名或單位名稱">
                </div>
                <div class="mb-3">
                  <label for="address" class="col-form-label">地址:</label>
                  <textarea class="form-control" id="address" placeholder="請輸入完整地址"></textarea>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
              <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="submit_address">
                <i class="fas fa-plus"></i> 新增
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- 页脚 -->
      <footer class="footer">
        <div class="container">
          <p class="m-0">© 2025 台灣郵局-存證信函產生器 | 快速產生格式合法、美觀的存證信函</p>
        </div>
      </footer>
    </div>
    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/scripts.js"></script>
	<script> 


		// 定义三个对象来分别存储不同类型的地址和计数器
		var fromAddressData = {
			addresses: [],
			counter: 1
		};

		var toAddressData = {
			addresses: [],
			counter: 1
		};

		var copyAddressData = {
			addresses: [],
			counter: 1
		};
		var type_now = ''

		var adressModal = document.getElementById('adressModal')
		adressModal.addEventListener('show.bs.modal', function (event) {
			var button = event.relatedTarget
			var type = button.getAttribute('data-bs-whatever')
			type_now = type
			var modalTitle = adressModal.querySelector('.modal-title')
			var modalBodyInput = adressModal.querySelector('.modal-body input')
			modalTitle.textContent = '編輯'+type+'資訊'
		})
		var clear_btn = document.getElementById('clear')
		clear_btn.addEventListener('click', function (event) {
			var letter_content = document.getElementById('letter_content')
			letter_content.value = ''
		})


		var submit_btn = document.getElementById('submit_address')
		submit_btn.addEventListener('click', function (event) {
			console.log(type_now)
			if(type_now == '寄件人'){
				
				address = document.getElementById('address').value
				name = document.getElementById('name').value
				cont = fromAddressData.counter
				fromAddressData.addresses.push({id:cont,name:name,address:address })
				document.getElementById('address').value = ''	
				document.getElementById('name').value = ''
				count = fromAddressData.counter
				fromAddressData.counter+=1
				type = 'from'
	
				
				
			}else if(type_now == '收件人'){
				address = document.getElementById('address').value
				name = document.getElementById('name').value
				cont = toAddressData.counter
				toAddressData.addresses.push({id:cont,name:name,address:address })
				document.getElementById('address').value = ''
				document.getElementById('name').value = ''
				count = toAddressData.counter+1
				fromAddressData.counter+=1
				type = "to"
				
			}else if(type_now == '副本地址'){
				address = document.getElementById('address').value
				name = document.getElementById('name').value
				cont = copyAddressData.counter
				copyAddressData.addresses.push({id:cont,name:name,address:address })
				document.getElementById('address').value = ''
				document.getElementById('name').value = ''	
				count = copyAddressData.counter+1
				fromAddressData.counter+=1
				type = "copy"
			}
			delete_key = type+"_" + count
			var cardHTML = `
					<div class="card" id="${delete_key}">
						<h5 class="card-header d-flex justify-content-between align-items-center">
							<span class="title"><i class="fas fa-user-circle me-2"></i>${name}</span>
							<button type="button" class="btn btn-danger btn-sm" onclick="delete_card('${type}', ${count})" >
								<i class="fas fa-trash-alt"></i> 刪除
							</button>
						</h5>
						<div class="card-body">
							<p class="card-text">
								<i class="fas fa-map-marker-alt me-2 text-secondary"></i>${address}
							</p>
						</div>
					</div>
				`;
			// addAddress(type_now)
			$("."+type+'_cards').append(cardHTML);
		})

		function delete_card(type,id){
			card_id = type + "_" + id
			document.getElementById(card_id).remove()
			if (type === 'from') {
				for (var i = 0; i < fromAddressData.addresses.length; i++) {
					if (fromAddressData.addresses[i].id === id) {
						fromAddressData.addresses.splice(i, 1);
						break;
					}
				}
			} else if (type === 'to') {
				for (var i = 0; i < toAddressData.addresses.length; i++) {
					if (toAddressData.addresses[i].id === id) {
						toAddressData.addresses.splice(i, 1);
						break;
					}
				}
			} else if (type === 'copy') {
				for (var i = 0; i < copyAddressData.addresses.length; i++) {
					if (copyAddressData.addresses[i].id === id) {
						copyAddressData.addresses.splice(i, 1);
						break;
					}
				}
			}
			
		}

		function deleteAddress(type, id) {
			// 根据类型找到相应的数组
			var addresses = type === 'from' ? fromAddressData.addresses : (type === 'to' ? toAddressData.addresses : copyAddressData.addresses);
		
			// 根据id找到相应的地址信息
			var addressInfo = addresses.find(function (addressInfo) {
				return addressInfo.id === id;
			});
		
			// 找到该地址信息在数组中的索引
			var index = addresses.indexOf(addressInfo);
		
			// 从数组中删除该地址信息
			addresses.splice(index, 1);
		}

		function addAddress(type) {
			var nameInput = document.getElementById('name');
			var addressInput = document.getElementById('address');
		
			var name = nameInput.value;
			var address = addressInput.value;
		
			var addressInfo = {
				id: type === 'from' ? fromAddressData.counter : (type === 'to' ? toAddressData.counter : copyAddressData.counter),
				name: name,
				address: address
			};
		
			// 根据类型将地址信息存储在相应的数组中
			if (type === '寄件人') {
				fromAddressData.addresses.push(addressInfo);
				fromAddressData.counter++;
			} else if (type === '收件人') {
				toAddressData.addresses.push(addressInfo);
				toAddressData.counter++;
			} else if (type === '副本地址') {
				copyAddressData.addresses.push(addressInfo);
				copyAddressData.counter++;
			}
		

			nameInput.value = '';
			addressInput.value = '';
		
			
		}

		function download() {
			console.log('download')
			//all collected data to json
			fromAddressData
			toAddressData
			copyAddressData

			payload = {
				"from":fromAddressData.addresses,
				"to":toAddressData.addresses,
				"copy":copyAddressData.addresses,
				"text": document.getElementById('letter_content').value
			}
			payload = JSON.stringify(payload)
			var xhr = new XMLHttpRequest();
			xhr.open("POST", "/generate", true);
			xhr.responseType = "blob"; // 設定回應型別為 Blob
			xhr.setRequestHeader("Content-Type", "application/json");
			xhr.send(JSON.stringify(payload));

			xhr.onload = function() {
				if (xhr.status === 200) {
					var blob = xhr.response;
					var link = document.createElement("a");
					link.href = window.URL.createObjectURL(blob);
					link.download = "letter.pdf";
					link.click();
				}
			};

		}
		
	</script>
	
    <!-- 頁腳 -->
    <footer class="footer">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <p class="m-0">© 2025 台灣郵局-存證信函產生器 | 快速產生格式合法、美觀的存證信函</p>
            <div class="footer-links">
              <a href="/" class="text-white mx-2">首頁</a>
              <a href="/privacy-policy" class="text-white mx-2">隱私權政策</a>
              <a href="/faq" class="text-white mx-2">常見問題</a>
              <a href="/about" class="text-white mx-2">關於我們</a>
              <a href="/terms" class="text-white mx-2">服務條款</a>
              <a href="/contact" class="text-white mx-2">聯絡我們</a>
              <a href="/sitemap" class="text-white mx-2">網站地圖</a>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
